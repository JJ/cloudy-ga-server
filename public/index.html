

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Distributed Evolutionary Algorithm</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">


    <script type="text/javascript" src='js/Chart.min.js'></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  
<style>

body {
  padding-top: 20px;
  padding-bottom: 20px;
}

.worker_line
{
height: 150px;
padding-right: 10px;

}


</style>

  </head>
  <body>

<div class="container">
      <div class="header clearfix">
        <nav>
          <ul class="nav nav-pills pull-right">
            <li role="presentation" class="active"><a href="#">Home</a></li>
            <li role="presentation"><a href="#">About</a></li>
            <li role="presentation"><a href="#">Contact</a></li>
          </ul>
        </nav>
        <h3 class="text-muted">An experiment in distributed evolutionary computation</h3>
      </div>

  <h1 class="page-header">How are we doing?</h1>
   <!---->
   <!-- WORKER 1-->
   <!---->
   <div class="row">
     <div class="col-md-12">
		 	<div class="panel panel-default">
  			<div class="panel-heading"> <i class="fa fa-cog"></i> Worker 1 </div>
		  	<div class="panel-body">
      		<div class="row">	
      		    <div class="col-md-4">
                 <h4>Parameters</h4>
                <ul class="list-group">
                    <li class="list-group-item"> Population  <span class="badge">254</span> </li>
                    <li class="list-group-item"> Generation  <span class="badge">142566</span> </li>
                
                </ul>
              </div>

      				<div class="col-md-4">
                <h4>Fitness</h4>
      						<canvas id="fitness_w1" class="worker_line" ></canvas>
      				</div>
      				

              <div class="col-md-4">
                   <h4>Best Chromosome</h4>
                  <canvas id="chromosome_w1" class="worker_line" ></canvas>
              </div>


      		</div>
      	</div>


		 </div>
	   </div>	 	
  </div>         
   <!---->
   <!-- WORKER 2-->
   <!---->
   <div class="row">
     <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading"> <i class="fa fa-cog"></i> Worker 2 </div>
        <div class="panel-body">
            <div class="row"> 
              <div class="col-md-4">
                 <h4>Parameters</h4>
                <ul class="list-group">
                    <li class="list-group-item"> Population  <span class="badge">254</span> </li>
                    <li class="list-group-item"> Generation  <span class="badge">142566</span> </li>
                
                </ul>
              </div>

              <div class="col-md-4">
                <h4>Fitness</h4>
                  <canvas id="fitness_w2" class="worker_line" ></canvas>
              </div>
              

              <div class="col-md-4">
                   <h4>Best Chromosome</h4>
                  <canvas id="chromosome_w2" class="worker_line" ></canvas>
              </div>


          </div>
      </div>


     </div>
     </div>   
  </div>         
  



   <div class="row">
		 <div class="col-md-8">
		 	<div class="panel panel-default">
  			<div class="panel-heading"> <h4 id="population-w2"> About This </h4> </div>
		  	<div class="panel-body">
			    <p>This is an experiment in distributed evolutionary
				  computation where you're contributing by just visiting this
				    page <em>and keeping it in focus</em>. You can read about it
				  in <a href='http://arxiv.org/abs/1503.06424'>this
				      paper</a>. Your browser will be evaluating a population
				  of <em>chromosomes</em>, <em>mutating</em> and mixing them
				  to create a new population in
				  an <a href='https://en.wikipedia.org/wiki/Evolutionary_algorithm'>evolutionary
				      algorithm</a> that sends every <code>n</code>
				  generations the best chromosome to the server, receiving a
				  random one. The row above represents the best chromosome so
				  far in shades of gray. The best one will be all black; the
				  algorithm will stop when it finds it.</p>  
		  	</div>
	  </div>
		 </div>
  		<div class="col-md-4">

		  <div class="panel panel-default">
	  			<div class="panel-heading"> <h4><i class="fa fa-cog"> </i> Get the data</h4> </div>
			  	<div class="panel-body">
				    <p>Processed and raw data will
		  be <a href='https://github.com/JJ/splash-volunteer/tree/data'>available
		      from GitHub</a>. Please
		  use <a href='https://github.com/JJ/splash-volunteer/issues'>the
		  issues section for suggestions and questions, as well as
		      feature requests.</a></p> 
			  	</div>
		  </div>
	  	</div>
	</div>


	  


    <footer class="footer">
      <div class="container">

      	  <p  id="footer1" class='text-centered text-muted'>Grab the code and data in <a href='https://github.com/JJ/splash-volunteer'>GitHub</a>. This is free software under the <a href='http://www.gnu.org/licenses/'>Affero GPL license</a>.</p>

          <p  id="footer2" class='text-centered text-muted'>Grab the code and data in <a href='https://github.com/JJ/splash-volunteer'>GitHub</a>. This is free software under the <a href='http://www.gnu.org/licenses/'>Affero GPL license</a>.</p>
        
      </div>
    </footer>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
   <script>


  var config = {  
      population_size : 128,
        period :  100,
        traps : 40,
      trap_len : 4,
        trap_b :  2
  }

// get line chart canvas
    var fitness_w1 = document.getElementById('fitness_w1').getContext('2d');
    var chromosome_w1 = document.getElementById('chromosome_w1').getContext('2d');


    var fitness_w2 = document.getElementById('fitness_w2').getContext('2d');
    var chromosome_w2 = document.getElementById('chromosome_w2').getContext('2d');
   // fitness.canvas.width=document.getElementById('canvas').clientWidth*0.9;
   // fitness.canvas.height=document.getElementById('canvas').clientHeight*0.8;

    // get #IPs chart canvas
   // var IPs = document.getElementById('IPs').getContext('2d');
   // IPs.canvas.width=document.getElementById('ips_canvas').clientWidth*0.9;
  //  IPs.canvas.height=document.getElementById('ips_canvas').clientHeight*0.7;

    // Chart data
    fitness_data_w1 = {
        labels : [],
        datasets : [
            {
                fillColor : "rgba(172,194,132,0.4)",
                strokeColor : "#ACC26D",
                pointColor : "#fff",
                pointStrokeColor : "#9DB86D",
                data : []
            }
        ]
    }

    fitness_chart_w1 = new Chart(fitness_w1).Line( fitness_data_w1, {  responsive: false,  animation: false ,  maintainAspectRatio: true});

    chromosome_data_w1 ={
        labels : Array.apply(null, new Array(160)).map(String.prototype.valueOf,""),
        datasets : [
            {
            fillColor:  "rgba(0,0,0,0.8)",
            strokeColor: "rgba(0,0,0,0.8)",
            data : Array.apply(null, new Array(160)).map(Number.prototype.valueOf,0),
            }
        ]
    }

    chromosome_chart_w1 = new Chart(chromosome_w1).Bar(chromosome_data_w1, 

                    {
                        scaleBeginAtZero : true,scaleShowGridLines : false,scaleShowHorizontalLines: false,
                        scaleShowVerticalLines: true, barShowStroke : false, barStrokeWidth : 0, barValueSpacing : 0,
                        barDatasetSpacing : 0,responsive: false, maintainAspectRatio: false ,  animation: false ,  
                        maintainAspectRatio: true 

                    });

      
      fitness_data_w2 = {
        labels : [],
        datasets : [
            {
                fillColor : "rgba(172,194,132,0.4)",
                strokeColor : "#ACC26D",
                pointColor : "#fff",
                pointStrokeColor : "#9DB86D",
                data : []
            }
        ]
    }

    fitness_chart_w2 = new Chart(fitness_w2).Line( fitness_data_w2, 
                {
                        scaleBeginAtZero : true,scaleShowGridLines : false,scaleShowHorizontalLines: false,
                        scaleShowVerticalLines: true, barShowStroke : false, barStrokeWidth : 0, barValueSpacing : 0,
                        barDatasetSpacing : 0,responsive: false, maintainAspectRatio: false ,  animation: false ,  
                        maintainAspectRatio: true 

                    });
    
    chromosome_data_w2 ={
        labels : Array.apply(null, new Array(160)).map(String.prototype.valueOf,""),
        datasets : [
            {
            fillColor:  "rgba(0,0,0,0.8)",
            strokeColor: "rgba(0,0,0,0.8)",
            //highlightFill: "rgba(220,220,220,0.75)",
            //highlightStroke: "rgba(220,220,220,1)",
            data : Array.apply(null, new Array(160)).map(Number.prototype.valueOf,0),
            }
        ]
    }

    chromosome_data_w2.labels 

    chromosome_chart_w2 = new Chart(chromosome_w2).Bar(chromosome_data_w2, 

                    {
                        scaleBeginAtZero : true,scaleShowGridLines : false,scaleShowHorizontalLines: false,
                        scaleShowVerticalLines: true, barShowStroke : false, barStrokeWidth : 0, barValueSpacing : 0,
                        barDatasetSpacing : 0,responsive: false, maintainAspectRatio: false ,  animation: false ,  
                        maintainAspectRatio: true 

                    });


    // Data for IPs.
   /* var ips_chart = new Chart(IPs,  { 
  responsive: true,
  maintainAspectRatio: true
    });
    var ips_data = {
        labels : [],
        datasets : [
            {
                fillColor : "rgba(160,204,182,0.4)",
                strokeColor : "#ACC26D",
                pointColor : "#ddd",
                pointStrokeColor : "#9DB86D",
                data : []
            }
        ]
    };
*/



   $( document ).ready(function() {
  // Handler for .ready() called.
var worker_1 = new Worker('js/trapWorker.js');

    worker_1.addEventListener('message', function(e) {

  	document.getElementById('footer1').textContent = "Worker 1: "+fitness_data_w1.labels.length+"--"+e.data.generation_count +"/Fitness:"+ e.data.fitness +"/Period:"+ e.data.period+"/IPS:"+ e.data.ips;

    // chart fitness
    if (e.data.generation_count !== undefined){


        if (fitness_data_w1.labels.length > 10)
        {
          //fitness_data.labels = fitness_data.labels.slice(1);
          //fitness_data.datasets[0].data = fitness_data.datasets[0].data.slice(1);
          fitness_chart_w1.removeData( );
        }
    
        //fitness_data.labels.push(e.data.generation_count);
        //fitness_data.datasets[0].data.push(e.data.fitness);
        fitness_chart_w1.addData([e.data.fitness],e.data.generation_count);
        fitness_chart_w1.update();
    }

    
     // Tracks the number of IPs
    //ips_data.labels.push(e.data.generation_count);
    //ips_data.datasets[0].data.push( e.data.ips );

    //ips_chart.Line(ips_data);


    //$("#best").html( tabify( e.data.best, config.trap_len,1, config.trap_b, config.trap_len -1 ));

    if (e.data.best !== undefined){
      for (var i=0; i<e.data.best.length; i++)
      {
        chromosome_chart_w1.datasets[0].bars[i].value =e.data.best[i];
        
      }
      chromosome_chart_w1.update();
    }


  }, false);

var worker_2 = new Worker('js/trapWorker.js');
    worker_2.addEventListener('message', function(e) {

    document.getElementById('footer2').textContent =  "Worker 2: "+fitness_data_w2.labels.length+"--"+e.data.generation_count +"/Fitness:"+ e.data.fitness +"/Period:"+ e.data.period+"/IPS:"+ e.data.ips;

    // chart fitness
    if (e.data.generation_count !== undefined){


        if (fitness_data_w2.labels.length > 10)
        {
          //fitness_data.labels = fitness_data.labels.slice(1);
          //fitness_data.datasets[0].data = fitness_data.datasets[0].data.slice(1);
          fitness_chart_w2.removeData( );
        }
    
        //fitness_data.labels.push(e.data.generation_count);
        //fitness_data.datasets[0].data.push(e.data.fitness);
        fitness_chart_w2.addData([e.data.fitness],e.data.generation_count);
        fitness_chart_w2.update();
    }

    
     // Tracks the number of IPs

    if (e.data.best !== undefined){
      for (var i=0; i<e.data.best.length; i++)
      {
        chromosome_chart_w2.datasets[0].bars[i].value =e.data.best[i];
        
      }
      chromosome_chart_w2.update();
    }

  }, false);


  worker_1.postMessage({'cmd': 'start', 'config': config});
  worker_1.postMessage({'cmd': 'evolve'});


  worker_2.postMessage({'cmd': 'start', 'config': config});
  worker_2.postMessage({'cmd': 'evolve'});

	});

  </script>



  

  </body>
</html>